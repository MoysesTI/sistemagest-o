<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PrismaTech - Gest√£o de Aulas</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <meta name="description"
        content="Sistema de gest√£o de turmas, professores e controle de aulas - PrismaTech Code Academy">
</head>

<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <img src="assets/logo.png" alt="PrismaTech" class="sidebar-logo">
            </div>

            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-item active" data-section="dashboard" onclick="showSection('dashboard')">
                        <i class="bi bi-grid-1x2 nav-icon"></i>
                        <span>Overview</span>
                    </div>
                    <div class="nav-item" data-section="turmas" onclick="showSection('turmas')">
                        <i class="bi bi-collection nav-icon"></i>
                        <span>Turmas</span>
                    </div>
                    <div class="nav-item" data-section="professores" onclick="showSection('professores')">
                        <i class="bi bi-people nav-icon"></i>
                        <span>Professores</span>
                    </div>
                    <div class="nav-item" data-section="cronograma" onclick="showSection('cronograma')">
                        <i class="bi bi-calendar3 nav-icon"></i>
                        <span>Cronograma</span>
                    </div>
                    <div class="nav-item" data-section="horas" onclick="showSection('horas')">
                        <i class="bi bi-clock-history nav-icon"></i>
                        <span>Horas & Pagamentos</span>
                    </div>
                    <div class="nav-item" data-section="dados" onclick="showSection('dados')">
                        <i class="bi bi-gear nav-icon"></i>
                        <span>Configura√ß√µes</span>
                    </div>
                </div>
            </nav>

            <div class="sidebar-footer">
                <div class="user-profile" onclick="showSection('dados')">
                    <div class="user-avatar">PT</div>
                    <div class="user-info-sidebar">
                        <div class="user-name-sidebar">PrismaTech Admin</div>
                        <div class="user-email-sidebar">admin@prismatech.com</div>
                    </div>
                    <i class="bi bi-chevron-expand" style="color: var(--text-muted);"></i>
                </div>
            </div>
        </aside>

        <!-- Overlay Mobile -->
        <div class="sidebar-overlay" id="sidebar-overlay" onclick="toggleSidebar()"></div>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <header>
                <div class="header-left">
                    <button class="menu-toggle" onclick="toggleSidebar()">
                        <i class="bi bi-list"></i>
                    </button>
                    <h1 class="page-title" id="page-title">Overview</h1>
                </div>

                <div class="header-center">
                    <div class="search-box">
                        <i class="bi bi-search"></i>
                        <input type="text" placeholder="Buscar...">
                    </div>
                </div>

                <div class="header-right">
                    <button class="header-btn"
                        onclick="showSection('turmas'); setTimeout(() => document.getElementById('btn-add-turma')?.click(), 100);">
                        <i class="bi bi-plus-lg"></i>
                        Nova Turma
                    </button>
                    <button class="header-icon-btn">
                        <i class="bi bi-bell"></i>
                    </button>
                </div>
            </header>

            <div class="container">
                <!-- DASHBOARD -->
                <section id="section-dashboard" class="content-section">
                    <div class="page-header">
                        <div>
                            <h2 class="page-header-title">Overview</h2>
                            <p class="page-header-subtitle">Monitore todas as atividades da academia</p>
                        </div>
                    </div>

                    <!-- Stats Cards -->
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-card-header">
                                <span class="stat-card-title">Total de Turmas</span>
                                <i class="bi bi-three-dots stat-card-menu"></i>
                            </div>
                            <div class="stat-value" id="stat-total-turmas">0</div>
                            <div class="stat-trend positive">
                                <i class="bi bi-arrow-up-short"></i>
                                <span>+12%</span>
                                <span class="stat-trend-text">desde o √∫ltimo m√™s</span>
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-card-header">
                                <span class="stat-card-title">Turmas Ativas</span>
                                <i class="bi bi-three-dots stat-card-menu"></i>
                            </div>
                            <div class="stat-value" id="stat-turmas-ativas">0</div>
                            <div class="stat-trend positive">
                                <i class="bi bi-arrow-up-short"></i>
                                <span>+8%</span>
                                <span class="stat-trend-text">desde o √∫ltimo m√™s</span>
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-card-header">
                                <span class="stat-card-title">Professores</span>
                                <i class="bi bi-three-dots stat-card-menu"></i>
                            </div>
                            <div class="stat-value" id="stat-professores">0</div>
                            <div class="stat-trend positive">
                                <i class="bi bi-arrow-up-short"></i>
                                <span>+2</span>
                                <span class="stat-trend-text">novos este m√™s</span>
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-card-header">
                                <span class="stat-card-title">Horas do M√™s</span>
                                <i class="bi bi-three-dots stat-card-menu"></i>
                            </div>
                            <div class="stat-value" id="stat-horas-mes">0h</div>
                            <div class="stat-trend positive">
                                <i class="bi bi-arrow-up-short"></i>
                                <span>+15%</span>
                                <span class="stat-trend-text">desde o √∫ltimo m√™s</span>
                            </div>
                        </div>
                    </div>

                    <!-- Two Column Layout -->
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem;">
                        <!-- Performance Card -->
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">Desempenho Geral</h3>
                                <i class="bi bi-info-circle" style="color: var(--text-muted);"></i>
                            </div>
                            <div class="card-body">
                                <div class="performance-circle" style="margin: 0 auto;">
                                    <svg viewBox="0 0 160 160" style="transform: rotate(-90deg);">
                                        <circle cx="80" cy="80" r="70" fill="none" stroke="#f3f4f6" stroke-width="12" />
                                        <circle cx="80" cy="80" r="70" fill="none" stroke="#22c55e" stroke-width="12"
                                            stroke-dasharray="439.8" stroke-dashoffset="88" stroke-linecap="round" />
                                    </svg>
                                    <div class="performance-value">
                                        <span class="performance-number" id="performance-score">79</span>
                                        <span class="performance-unit">de 100 pontos</span>
                                    </div>
                                </div>
                                <div class="performance-message" style="margin-top: 1rem;">
                                    <p class="performance-title">Sua equipe est√° √≥tima! üöÄ</p>
                                    <p class="performance-description">O desempenho est√° acima da m√©dia, mantendo
                                        consist√™ncia nos resultados.</p>
                                </div>
                            </div>
                        </div>

                        <!-- Top Professores -->
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">Top Professores</h3>
                                <i class="bi bi-three-dots" style="color: var(--text-muted);"></i>
                            </div>
                            <div class="card-body">
                                <div class="employee-list" id="top-professores">
                                    <!-- Populated via JS -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Pr√≥ximas Aulas -->
                    <div class="card" style="margin-top: 1.5rem;">
                        <div class="card-header">
                            <h3 class="card-title">Aulas de Hoje</h3>
                            <button class="btn btn-sm btn-secondary" onclick="showSection('cronograma')">
                                <i class="bi bi-calendar3"></i>
                                Ver Cronograma
                            </button>
                        </div>
                        <div class="card-body">
                            <div class="upcoming-classes" id="proximas-aulas">
                                <p style="color: var(--text-muted); text-align: center; padding: 2rem;">Carregando...
                                </p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- TURMAS -->
                <section id="section-turmas" class="content-section" style="display: none;">
                    <div class="page-header">
                        <div>
                            <h2 class="page-header-title">Gest√£o de Turmas</h2>
                            <p class="page-header-subtitle">Gerencie suas turmas e acompanhe o progresso</p>
                        </div>
                        <button id="btn-add-turma" class="btn btn-accent">
                            <i class="bi bi-plus-lg"></i>
                            Nova Turma
                        </button>
                    </div>

                    <div class="controls">
                        <div class="filter-options">
                            <button class="filter-btn active" data-filter="all">Todas</button>
                            <button class="filter-btn" data-filter="segunda">Segunda</button>
                            <button class="filter-btn" data-filter="terca">Ter√ßa</button>
                            <button class="filter-btn" data-filter="quarta">Quarta</button>
                            <button class="filter-btn" data-filter="quinta">Quinta</button>
                            <button class="filter-btn" data-filter="sexta">Sexta</button>
                            <button class="filter-btn" data-filter="sabado">S√°bado</button>
                        </div>
                        <input type="text" class="search-input" placeholder="Buscar turma...">
                    </div>

                    <div class="turma-grid" id="turma-container">
                        <!-- Turmas via JS -->
                    </div>
                </section>

                <!-- PROFESSORES -->
                <section id="section-professores" class="content-section" style="display: none;">
                    <div class="page-header">
                        <div>
                            <h2 class="page-header-title">Professores</h2>
                            <p class="page-header-subtitle">Cadastro e gest√£o de professores MEI</p>
                        </div>
                        <button class="btn btn-accent" onclick="abrirModalProfessor()">
                            <i class="bi bi-plus-lg"></i>
                            Novo Professor
                        </button>
                    </div>

                    <div class="turma-grid" id="professores-container">
                        <!-- Professores via JS -->
                    </div>
                </section>

                <!-- CRONOGRAMA -->
                <section id="section-cronograma" class="content-section" style="display: none;">
                    <div class="page-header">
                        <div>
                            <h2 class="page-header-title">Cronograma Semanal</h2>
                            <p class="page-header-subtitle">Visualiza√ß√£o de aulas por semana</p>
                        </div>
                        <div style="display: flex; gap: 0.5rem;">
                            <button class="btn btn-secondary" onclick="mudarSemana(-1)">
                                <i class="bi bi-chevron-left"></i>
                            </button>
                            <button class="btn btn-accent" onclick="mudarSemana(0)">Hoje</button>
                            <button class="btn btn-secondary" onclick="mudarSemana(1)">
                                <i class="bi bi-chevron-right"></i>
                            </button>
                        </div>
                    </div>

                    <div id="cronograma-container" class="card">
                        <div class="card-body">
                            <!-- Cronograma via JS -->
                        </div>
                    </div>
                </section>

                <!-- HORAS -->
                <section id="section-horas" class="content-section" style="display: none;">
                    <div class="page-header">
                        <div>
                            <h2 class="page-header-title">Controle de Horas & Pagamentos</h2>
                            <p class="page-header-subtitle">Horas trabalhadas e remunera√ß√£o por professor</p>
                        </div>
                        <select id="mes-selecionado" class="form-select" style="width: auto;"
                            onchange="atualizarHoras()">
                            <!-- Meses via JS -->
                        </select>
                    </div>

                    <!-- Par√¢metros de Remunera√ß√£o -->
                    <div class="card" style="margin-bottom: 1.5rem;">
                        <div class="card-header">
                            <h3 class="card-title">
                                <i class="bi bi-cash-coin" style="margin-right: 0.5rem;"></i>
                                Par√¢metros de Remunera√ß√£o
                            </h3>
                        </div>
                        <div class="card-body">
                            <div class="hours-grid" style="grid-template-columns: repeat(3, 1fr);">
                                <div class="hour-item">
                                    <div class="hour-value">R$ 27,00</div>
                                    <div class="hour-label">Hora-aula base</div>
                                </div>
                                <div class="hour-item">
                                    <div class="hour-value" style="color: var(--success);">R$ 35,91</div>
                                    <div class="hour-label">Com bonifica√ß√£o (33%)</div>
                                </div>
                                <div class="hour-item">
                                    <div class="hour-value">80%</div>
                                    <div class="hour-label">Reten√ß√£o</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="horas-container">
                        <!-- Horas via JS -->
                    </div>
                </section>

                <!-- DADOS/CONFIG -->
                <section id="section-dados" class="content-section" style="display: none;">
                    <div class="page-header">
                        <div>
                            <h2 class="page-header-title">Configura√ß√µes</h2>
                            <p class="page-header-subtitle">Backup, importa√ß√£o e gerenciamento de dados</p>
                        </div>
                    </div>

                    <div class="data-section">
                        <h3 class="data-section-title">
                            <i class="bi bi-database"></i>
                            Gerenciamento de Dados
                        </h3>

                        <div class="data-actions">
                            <button id="btn-exportar" class="btn btn-primary">
                                <i class="bi bi-clipboard"></i>
                                Exportar para Clipboard
                            </button>
                            <button id="btn-salvar-arquivo" class="btn btn-primary">
                                <i class="bi bi-download"></i>
                                Salvar em Arquivo
                            </button>
                            <button id="btn-importar" class="btn btn-secondary">
                                <i class="bi bi-upload"></i>
                                Importar do Clipboard
                            </button>
                            <button id="btn-importar-arquivo" class="btn btn-secondary">
                                <i class="bi bi-folder2-open"></i>
                                Importar de Arquivo
                            </button>
                            <button id="btn-reset" class="btn btn-danger">
                                <i class="bi bi-trash"></i>
                                Limpar Dados
                            </button>
                        </div>

                        <textarea id="data-text" class="data-textarea"
                            placeholder="Cole os dados JSON aqui para importar..."></textarea>
                    </div>
                </section>
            </div>
        </main>
    </div>

    <!-- Modal de Aulas -->
    <div class="modal" id="aula-modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3 class="modal-title" id="modal-title">Aulas da Turma</h3>
                <button class="modal-close" id="close-modal">&times;</button>
            </div>
            <div class="modal-body" id="modal-content-container">
                <!-- Conte√∫do do modal -->
            </div>
        </div>
    </div>

    <!-- Modal de Professor -->
    <div class="modal" id="professor-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="professor-modal-title">Cadastrar Professor</h3>
                <button class="modal-close" onclick="fecharModalProfessor()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="professor-form">
                    <div class="form-group">
                        <label class="form-label">Nome Completo *</label>
                        <input type="text" id="prof-nome" class="form-input" required placeholder="Nome do professor">
                    </div>

                    <div class="form-group">
                        <label class="form-label">E-mail</label>
                        <input type="email" id="prof-email" class="form-input" placeholder="email@exemplo.com">
                    </div>

                    <div class="form-group">
                        <label class="form-label">Telefone</label>
                        <input type="tel" id="prof-telefone" class="form-input" placeholder="(00) 00000-0000">
                    </div>

                    <h4
                        style="margin: 1.5rem 0 1rem; color: var(--text-primary); display: flex; align-items: center; gap: 0.5rem;">
                        <i class="bi bi-building"></i>
                        Dados MEI
                    </h4>

                    <div class="form-group">
                        <label class="form-label">CNPJ</label>
                        <input type="text" id="prof-cnpj" class="form-input" placeholder="00.000.000/0001-00">
                    </div>

                    <div class="form-group">
                        <label class="form-label">Raz√£o Social</label>
                        <input type="text" id="prof-razao" class="form-input" placeholder="Nome da empresa ME">
                    </div>

                    <div class="form-group">
                        <label class="form-label">M√≥dulos/Cursos</label>
                        <div class="checkbox-group">
                            <div class="checkbox-item">
                                <input type="checkbox" name="modulos" value="canva" id="mod-canva">
                                <label for="mod-canva">Canva</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" name="modulos" value="figma" id="mod-figma">
                                <label for="mod-figma">Figma</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" name="modulos" value="excel" id="mod-excel">
                                <label for="mod-excel">Excel</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" name="modulos" value="word" id="mod-word">
                                <label for="mod-word">Word</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" name="modulos" value="unity" id="mod-unity">
                                <label for="mod-unity">Unity</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" name="modulos" value="informatica_powerbi" id="mod-powerbi">
                                <label for="mod-powerbi">Power BI</label>
                            </div>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary"
                            onclick="fecharModalProfessor()">Cancelar</button>
                        <button type="submit" class="btn btn-accent">
                            <i class="bi bi-check-lg"></i>
                            Salvar Professor
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Notifica√ß√£o -->
    <div class="notification" id="notification">
        <i class="bi bi-check-circle"></i>
        <span>Altera√ß√µes salvas com sucesso!</span>
    </div>

    <script src="api.js"></script>
    <script src="script.js"></script>
    <script>
        // Verificar autentica√ß√£o ao carregar
        (async () => {
            const isAuth = await API.checkAuth();
            if (!isAuth) {
                window.location.href = 'login.html';
                return;
            }

            // Atualizar UI com info do usu√°rio
            const user = API.getCurrentUser();
            const userNameEl = document.querySelector('.user-name-sidebar');
            const userEmailEl = document.querySelector('.user-email-sidebar');
            const userAvatarEl = document.querySelector('.user-avatar');

            if (userNameEl) userNameEl.textContent = user.nome;
            if (userEmailEl) userEmailEl.textContent = user.email;
            if (userAvatarEl) userAvatarEl.textContent = user.nome.charAt(0).toUpperCase();

            // Mostrar/ocultar se√ß√µes admin-only
            if (!API.isAdmin()) {
                const profsMenuItem = document.querySelector('[data-section="professores"]');
                if (profsMenuItem) profsMenuItem.style.display = 'none';
            }
        })();
    </script>
</body>

</html>